#!/bin/sh 

set -e

battery_dir="/sys/class/power_supply/BAT0"

capacity=$(cat $battery_dir/capacity)
power_now=$(cat $battery_dir/power_now)

energy_full=$(cat $battery_dir/energy_full) 
energy_now=$(cat $battery_dir/energy_now) 

remaning_minutes=$(echo ${power_now} ${energy_now} | awk '{ printf "%d", $2 / $1 * 60 }')
until_empty=$(date -d "+${remaning_minutes} minutes" "+%H:%M")

echo \
	${capacity} \
	${power_now} \
	${remaning_minutes} \
	${until_empty} \
	| awk '{ printf "%d% (%1.2fW) %1.2fh (ï•Œ %s)\n", $1, $2 * 10^-6, $3 / 60, $4 }'
