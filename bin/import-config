#!/bin/sh

# repo -> host
#
# This script takes the `./file-list` and copies these files from the repo to 
# the host. 

set -e

read -p "This will overwrite your LOCAL files, are you sure?" -n 1 -r
echo
if [[ ! $REPLY =~ ^[Yy]$ ]]; then 
	echo -n "Ok, we'll wait."
	exit 0
fi

# fetch list and remove comments and blank lines
sed '/\(^$\|^#\)/d' bin/file-list | \
  sed 's|~|'${HOME}'|g' | \
  while read line; do 
    files=($line)

    repo_location=${files[0]}
    host_location=${files[1]}
    sudo_required=""

    # if host has / add * 
    if [[ ${repo_location} == */ ]]; then 
      repo_location="${repo_location}*"
    fi 
    
    # if path does not start with home folder, sudo is required
    if [[ ${host_location} != $HOME* ]]; then 
      sudo_required="sudo "
    fi 

    ${sudo_required} cp -r ${repo_location} ${host_location}
    echo "${repo_location} -> ${host_location}"
  done
